<!DOCTYPE html>
<html>
  <head>
    <title>依序播放多段 YouTube 片段</title>
    <style>
      #caption {
        display: none; /* 初始不顯示文字 */
        font-size: 18px;
        text-align: center;
        margin-top: 10px;
        color: #333;
      }
    </style>
  </head>
  <body>
    <div id="player"></div>
    <div id="caption">是戒毒曲</div> <!-- 顯示「是戒毒曲」的容器 -->
    
    <script>
      // 載入 YouTube IFrame API
      var tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      var player;
      var videoQueue = [ 
        { videoId: "rYymKe82y0c", start: 64, end: 66 }, // 第一段視頻：1:04-1:06
        { videoId: "QA5zuzc1WYA", start: 49, end: 52 }, // 第二段視頻：0:49-0:52
        { videoId: "Y0EcKR05Ac4", start: 0, end: 13 },  // 第三段視頻：0:00-0:13
        { videoId: "MDqvUzdOR0Q", start: 140, end: 146 } // 第四段視頻：2:20-2:26
      ];
      var currentVideoIndex = 0; // 當前播放的視頻索引

      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: '390',
          width: '640',
          videoId: videoQueue[currentVideoIndex].videoId, // 初始載入第一段視頻
          playerVars: {
            start: videoQueue[currentVideoIndex].start,
            end: videoQueue[currentVideoIndex].end
          },
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
      }

      function onPlayerReady(event) {
        event.target.playVideo(); // 自動播放當前段視頻
      }

      function onPlayerStateChange(event) {
        if (event.data === YT.PlayerState.ENDED) { // 當前片段播放結束
          currentVideoIndex++;
          if (currentVideoIndex < videoQueue.length) {
            // 如果即將播放第三部影片，顯示文字
            if (currentVideoIndex === 2) {
              showCaption();
            } else {
              hideCaption();
            }
            // 播放下一段
            player.loadVideoById({
              videoId: videoQueue[currentVideoIndex].videoId,
              startSeconds: videoQueue[currentVideoIndex].start,
              endSeconds: videoQueue[currentVideoIndex].end
            });
          } else {
            console.log("所有视频播放完成");
            hideCaption(); // 最後播放完隱藏文字
          }
        }
      }

      function showCaption() {
        document.getElementById('caption').style.display = 'block';
      }

      function hideCaption() {
        document.getElementById('caption').style.display = 'none';
      }
    </script>
  </body>
</html>
